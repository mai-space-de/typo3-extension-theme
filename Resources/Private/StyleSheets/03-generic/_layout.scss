// =============================================================================
// 03-generic/_layout.scss
//
// Base layout system built on CSS Grid and CSS custom properties.
// Implements the "Every Layout" style patterns (main grid, sidebar, reel, etc.)
// and TYPO3-friendly content-column classes.
//
// Override any variable in :root or a scoping selector to customise widths,
// gaps, and column counts without touching this file.
// =============================================================================

@use "../02-mixins/media-breakpoint" as *;

// ---------------------------------------------------------------------------
// Main content grid
// Provides full-bleed, feature, popout, indent, and content zones.
// ---------------------------------------------------------------------------
.main-grid {
    --_grid-gap:      var(--layout-grid-gap);
    --_content-max:   var(--layout-content-width);

    display: grid;
    grid-template-columns:
        [full-start]
            minmax(var(--_grid-gap), 1fr)
            [feature-start]
                minmax(0, var(--space-3xl))
                [popout-start]
                    minmax(0, var(--space-xl))
                    [indent-start]
                        minmax(0, var(--space-md))
                        [content-start]
                            min(var(--_content-max), 100% - var(--_grid-gap) * 2)
                        [content-end]
                        minmax(0, var(--space-md))
                    [indent-end]
                minmax(0, var(--space-xl))
            [popout-end]
        minmax(0, var(--space-3xl))
    [feature-end]
        minmax(var(--_grid-gap), 1fr)
        [full-end];

    > * {
        grid-column: content;
    }

    > .full-width  { grid-column: full; }
    > .feature     { grid-column: feature; }
    > .popout      { grid-column: popout; }
    > .indent      { grid-column: indent; }
}

// ---------------------------------------------------------------------------
// Sidebar layout (main + aside, side by side when space allows)
// ---------------------------------------------------------------------------
.sidebar-layout {
    display: flex;
    flex-wrap: wrap;
    gap: var(--layout-grid-gap);

    // Primary content grows to fill available space.
    > :first-child {
        flex-basis: var(--layout-sidebar-main);
        flex-grow:  1;
    }

    // Secondary / aside stays constrained.
    > :last-child {
        flex-basis: var(--layout-sidebar-aside);
        flex-grow:  1;
    }
}

// ---------------------------------------------------------------------------
// Reel — horizontal scroll container with snap.
// ---------------------------------------------------------------------------
.reel {
    display:           flex;
    gap:               var(--layout-grid-gap);
    overflow-x:        auto;
    scroll-snap-type:  x mandatory;
    scrollbar-width:   thin;
    padding-block-end: var(--space-sm); // space for the scrollbar

    > * {
        flex:             0 0 80%;
        scroll-snap-align: start;

        @include bp-up(sm) {
            flex-basis: 40%;
        }

        @include bp-up(lg) {
            flex-basis: 20%;
        }
    }
}

// ---------------------------------------------------------------------------
// Flex grid — equal-width wrapping flex layout.
// ---------------------------------------------------------------------------
.flex-grid {
    display:   flex;
    flex-wrap: wrap;
    gap:       var(--layout-grid-gap);

    > * {
        flex: 1 1 var(--layout-grid-min-col);
    }
}

// ---------------------------------------------------------------------------
// Auto grid — CSS Grid with auto-fit columns.
// Override --grid-min-col to control the minimum column width.
// ---------------------------------------------------------------------------
.auto-grid {
    --grid-min-col: var(--layout-grid-min-col);

    display:               grid;
    grid-template-columns: repeat(auto-fit, minmax(var(--grid-min-col), 1fr));
    gap:                   var(--layout-grid-gap);
}

// ---------------------------------------------------------------------------
// Card grid — dense packing for card-type components.
// ---------------------------------------------------------------------------
.card-grid {
    --card-min-col: var(--layout-card-width);

    display:               grid;
    grid-template-columns: repeat(auto-fill, minmax(var(--card-min-col), 1fr));
    grid-auto-rows:        auto;
    gap:                   var(--layout-grid-gap);
}

// ---------------------------------------------------------------------------
// Cluster — inline grouping of items (tags, badges, button rows).
// ---------------------------------------------------------------------------
.cluster {
    display:   flex;
    flex-wrap: wrap;
    gap:       var(--space-sm);
    align-items: center;
}

// ---------------------------------------------------------------------------
// Container — centres content and constrains max width.
// ---------------------------------------------------------------------------
.container {
    width:      100%;
    max-width:  var(--layout-width-max);
    margin-inline: auto;
    padding-inline: var(--layout-grid-gap);
}

// ---------------------------------------------------------------------------
// Section spacing — consistent vertical rhythm between page sections.
// ---------------------------------------------------------------------------
.section {
    padding-block: var(--space-3xl);
}

// ---------------------------------------------------------------------------
// Flow — adds margin between direct children for vertical rhythm.
// Override --flow-space to change the rhythm locally.
// ---------------------------------------------------------------------------
.flow > * + * {
    margin-block-start: var(--flow-space, 1em);
}
